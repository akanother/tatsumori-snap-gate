import d from"./BaseKpiCard-CgfSCTnv.js";import{_ as c}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as h,f as a,o as r,a as m,w as _,b as s,h as p,t as o,e as g}from"./app-DNec1a2P.js";const w={name:"LatestUnansweredOrdersPanel",components:{BaseKpiCard:d},data(){return{loading:!0,backlogTotal:0,newThisMonth:0,newPrevMonth:0,newToday:0,new7days:0,lastUpdated:null,error:null}},mounted(){this.fetchMetrics()},methods:{async fetchMetrics(){this.loading=!0,this.error=null;try{const n=route("dashboard.unanswered.metrics"),{data:e}=await axios.get(n);this.backlogTotal=e.backlog_total??0,this.newThisMonth=e.new_this_month??0,this.newPrevMonth=e.new_prev_month??0,this.newToday=e.new_today??0,this.new7days=e.new_7days??0,this.lastUpdated=new Date}catch(n){console.error("未回答メトリクス取得失敗:",n),this.error="読み込みに失敗しました"}finally{this.loading=!1}}}},u={class:"col-sm-3"},f={class:"fw-bold mb-1 bg-dark rounded-lg p-2"},y={key:0,class:"text-white"},b={key:1,class:"fs-3"},k={class:"text-muted",style:{"line-height":"1.4"}},v={class:"small mt-1"},x={key:0,class:"text-danger small mt-2"};function T(n,e,M,U,t,l){const i=h("BaseKpiCard");return r(),a("div",u,[m(i,{title:"最新の受注情報（未回答）",loading:t.loading,lastUpdated:t.lastUpdated,icon:"mdi mdi-account-multiple",onRefresh:l.fetchMetrics},{default:_(()=>[s("div",f,[t.loading?(r(),a("span",b,"...")):(r(),a("h4",y,o(t.backlogTotal.toLocaleString())+"件",1))]),e[1]||(e[1]=s("div",{class:"w-100 my-2",style:{height:"1px",background:"rgba(0,0,0,.06)"}},null,-1)),s("div",k,[e[0]||(e[0]=g(" 今月新規： ")),s("strong",null,o(t.loading?"...":t.newThisMonth.toLocaleString()),1),s("div",v," 今日："+o(t.loading?"...":t.newToday)+" ／ 直近7日："+o(t.loading?"...":t.new7days),1)]),e[2]||(e[2]=s("p",{class:"mt-1"},"工場出荷予定・納期が未回答の受注情報を集計しています",-1)),t.error?(r(),a("div",x,o(t.error),1)):p("",!0)]),_:1,__:[1,2]},8,["loading","lastUpdated","onRefresh"])])}const N=c(w,[["render",T]]);export{N as default};
